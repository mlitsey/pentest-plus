SOURCE_DIR=~/date_test
START_LAST_MONTH=`date --date="$(date --rfc-3339=date | cut --characters=-7)-01 - 1 month" --rfc-3339=second`
END_LAST_MONTH=`date --date="$(date --rfc-3339=date | cut --characters=-7)-01 - 1 second" --rfc-3339=second`
END_2_MONTH_AGO=`date --date="$(date --rfc-3339=date | cut --characters=-7)-01 -1 month - 1 second" --rfc-3339=second`


cd
mkdir date_test
cd ~/date_test
touch --date="$(date --date="$(date --rfc-3339=date | cut --characters=-7)-01 - 1 month" --rfc-3339=second)" start-of-last-month
touch --date="$(date --date="$(date --rfc-3339=date | cut --characters=-7)-01 - 1 day" --rfc-3339=second)" last-day-of-last-month
touch --date="$(date --date="$(date --rfc-3339=date | cut --characters=-7)-01 - 1 second" --rfc-3339=second)" end-of-last-month
touch --date="$(date --date="$(date --rfc-3339=date | cut --characters=-7)-01 - 1 month - 1 second" --rfc-3339=second)" end-of-two-month-ago
touch --date="$(date --rfc-3339=date | cut --characters=-7)-01" start-of-current-month
touch --date="$(date --date="$(date --rfc-3339=date | cut --characters=-7)-01 + 1 month - 1 second" --rfc-3339=second)" end-of-current-month
touch --date="$(date --date="$(date --rfc-3339=date | cut --characters=-7)-01 + 1 month" --rfc-3339=second)" start-of-next-month
stat --printf '%y\t%n\n' ./* | sort --key=1
# 2020-06-30 00:00:00.000000000 +1200 ./last-day-of-last-month
# 2020-06-30 23:59:59.000000000 +1200 ./end-of-last-month
# 2020-07-01 00:00:00.000000000 +1200 ./start-of-current-month
# 2020-07-31 23:59:59.000000000 +1200 ./end-of-current-month
# 2020-08-01 00:00:00.000000000 +1200 ./start-of-next-month
find . -mindepth 1 -newermt "$(date --rfc-3339=date | cut --characters=-7)-01 - 1 second" -not -newermt "$(date --rfc-3339=date | cut --characters=-7)-01 + 1 month - 1 second"
# ./end-of-current-month
# ./start-of-current-month

date -R
date --date='-1 month' +'Last month was %B?'
date --date="$(date +%Y-%m-15) -1 month" +'Last month was %B!'
date --date="$(date %Y%m) -1 month"
printf "start of last month "
date -d "$(date +%y-%m-1) - 1 month" +%y-%m-%d
printf "end of last month "
date +%y-%m-1
printf "this didn't work"
#/usr/bin/find $SOURCE_DIR -maxdepth 1 -type f -name 'files*.pdf' -newermt "$(date -d "$(date +%y-%m-1) - 1 month" +%y-%m-%d)" -not -newermt "$(date +%y-%m-1)"

printf "\n print variable START_LAST_MONTH \n"
echo $START_LAST_MONTH
printf "\n print variable END_LAST_MONTH \n"
echo $END_LAST_MONTH

printf "\n find all files from last month in $SOURCE_DIR"
find $SOURCE_DIR -maxdepth 1 -type f -name 'files*.pdf' -newermt "$END_2_MONTH_AGO" -not -newermt "$END_LAST_MONTH"

printf "\n find all files from last month in $SOURCE_DIR and put them in a tar file"
find $SOURCE_DIR -maxdepth 1 -type f -name 'files*.pdf' -newermt "$END_2_MONTH_AGO" -not -newermt "$END_LAST_MONTH"